<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>Device Intelligence</title>
    <script type="module">
      import DeviceIntelligence from './index.mjs'

      const { getBrowserData } = DeviceIntelligence || {}

      async function fetchData() {
        try {
          console.log('DeviceIntelligence SDK Loaded:', DeviceIntelligence)

          if (!getBrowserData) {
            throw new Error('getBrowserData function is not available!')
          }

          console.log('Fetching Browser Data...')
          let combinedData = await getBrowserData(340, 500)
          console.log('Combined Browser and Risk Data:', combinedData)

          let tableBody = document.getElementById('browser-data-table')
          for (const key in combinedData) {
            let tr = document.createElement('tr')
            tr.innerHTML = `<td>${key}</td><td>${combinedData[key]}</td>`
            tableBody.appendChild(tr)
          }

        } catch (error) {
          console.error('Error fetching data:', error)
        }
      }

      window.addEventListener('DOMContentLoaded', () => {
        console.log('DOM fully loaded, starting fetchData...')
        fetchData()
      })
    </script>
  </head>
  <body>
    <div class="container mt-2">
      <h2>Combined Browser and Risk Data</h2>
      <!-- Data Table -->
      <table class="table table-striped table-bordered">
        <thead>
          <tr>
            <th scope="col">Key</th>
            <th scope="col">Value</th>
          </tr>
        </thead>
        <tbody id="browser-data-table"></tbody>
      </table>
    </div>
  </body>
</html>
